# =========================================================
# MT7986 / Filogic 830 · Kernel 6.12
# OpenWrt / ImmortalWrt 25.12
# Netfilter / iptables / fw4 · FINAL SAFE OVERRIDE
# =========================================================

# ---------------------------------------------------------
# CPU / Scheduler
# ---------------------------------------------------------
CONFIG_HZ=250
CONFIG_HZ_250=y

CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_STAT=y
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y
CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL=y
# CONFIG_CPU_FREQ_GOV_PERFORMANCE is not set
# CONFIG_SCHED_AUTOGROUP is not set


# ---------------------------------------------------------
# Memory
# ---------------------------------------------------------
# CONFIG_TRANSPARENT_HUGEPAGE is not set
# CONFIG_ARCH_WANTS_THP_SWAP is not set
# CONFIG_SWAP is not set


# ---------------------------------------------------------
# Networking core
# ---------------------------------------------------------
CONFIG_IPV6=y

CONFIG_RPS=y
CONFIG_XPS=y
# CONFIG_RFS_ACCEL is not set


# ---------------------------------------------------------
# Netfilter core (‼必须模块化‼)
# ---------------------------------------------------------
CONFIG_NETFILTER=m
CONFIG_NETFILTER_ADVANCED=y


# ---------------------------------------------------------
# Conntrack (iptables / AppFilter 必须 · 模块化)
# ---------------------------------------------------------
CONFIG_NF_CONNTRACK=m
CONFIG_NF_CONNTRACK_EVENTS=y
CONFIG_NF_CONNTRACK_TIMESTAMP=y

CONFIG_NF_DEFRAG_IPV6=m


# ---------------------------------------------------------
# IPv6 iptables core
# ---------------------------------------------------------
CONFIG_IP6_NF_IPTABLES=m

CONFIG_IP6_NF_FILTER=m
CONFIG_IP6_NF_MANGLE=m
CONFIG_IP6_NF_RAW=m


# ---------------------------------------------------------
# Logging (kmod-nf-log6 依赖)
# ---------------------------------------------------------
CONFIG_NF_LOG_COMMON=m
CONFIG_NF_LOG_IPV6=m


# ---------------------------------------------------------
# Flow offload / HNAT (OpenWrt 兼容模式)
# ---------------------------------------------------------
CONFIG_NF_FLOW_TABLE=m
CONFIG_NF_FLOW_TABLE_INET=m
CONFIG_NET_MEDIATEK_HNAT=y


# ---------------------------------------------------------
# BPF (control-plane only)
# ---------------------------------------------------------
CONFIG_BPF=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF_JIT=y
CONFIG_BPF_EVENTS=y
# CONFIG_BPF_JIT_ALWAYS_ON is not set
# CONFIG_DEBUG_INFO_BTF is not set


# ---------------------------------------------------------
# Preemption model
# ---------------------------------------------------------
CONFIG_KERNEL_PREEMPT_VOLUNTARY=y
# CONFIG_KERNEL_PREEMPT is not set


# ---------------------------------------------------------
# Security (production safe)
# ---------------------------------------------------------
CONFIG_STACKPROTECTOR_STRONG=y
CONFIG_RODATA_FULL_DEFAULT_ENABLED=y
CONFIG_SECURITY=y
CONFIG_SECURITY_NETWORK=y
CONFIG_CPU_MITIGATIONS=y


# ---------------------------------------------------------
# Debug / Dev (fully disabled)
# ---------------------------------------------------------
# CONFIG_DEBUG_KERNEL is not set
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_MISC is not set
# CONFIG_DEBUG_FS is not set
# CONFIG_MAGIC_SYSRQ is not set
# CONFIG_KALLSYMS is not set
# CONFIG_KALLSYMS_ALL is not set
# CONFIG_COREDUMP is not set
CONFIG_MTK_LVTS_THERMAL_DEBUGFS=y


# ---------------------------------------------------------
# Namespaces / Cgroups (router minimalism)
# ---------------------------------------------------------
# CONFIG_USER_NS is not set
# CONFIG_PID_NS is not set
# CONFIG_IPC_NS is not set

# CONFIG_CGROUP_DEVICE is not set
# CONFIG_CGROUP_PIDS is not set
# CONFIG_CGROUP_FREEZER is not set
# CONFIG_CGROUP_CPUACCT is not set
# CONFIG_NET_CLS_CGROUP is not set
# CONFIG_RT_GROUP_SCHED is not set
