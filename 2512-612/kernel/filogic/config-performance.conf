
# =========================================================
# MT7986 / Filogic 830 · Final Override Layer

# CPU / 调度 · 最终确认
# 确保 HZ=250 与 schedutil 不被 defconfig 回滚
CONFIG_HZ=250
CONFIG_HZ_250=y

CONFIG_CPU_FREQ=y
CONFIG_CPU_FREQ_STAT=y
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y
CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL=y
# CONFIG_CPU_FREQ_GOV_PERFORMANCE is not set
# CONFIG_SCHED_AUTOGROUP is not set


# ---------------------------------------------------------
# 内存管理 · 最终确认
# ---------------------------------------------------------
#
# CONFIG_TRANSPARENT_HUGEPAGE is not set
# CONFIG_ARCH_WANTS_THP_SWAP is not set
# CONFIG_SWAP is not set

# ---------------------------------------------------------
# 网络数据路径 · 最终裁决
# ---------------------------------------------------------
# 保留 RPS / XPS（运行时调优）
#
CONFIG_RPS=y
CONFIG_XPS=y
# CONFIG_RFS_ACCEL is not set


# ---------------------------------------------------------
# Conntrack · 明确开启（为 AppFilter / 状态跟踪服务）
# ---------------------------------------------------------
CONFIG_NF_CONNTRACK=y
CONFIG_NF_CONNTRACK_EVENTS=y
CONFIG_NF_CONNTRACK_TIMESTAMP=y


# ---------------------------------------------------------
# Flow / HNAT · 裁决说明
# ---------------------------------------------------------
# 保留 NF_FLOW_TABLE + MTK HNAT
# （你当前选择的是“兼容优先”模式，而非极限单一路径）
#
CONFIG_NF_FLOW_TABLE=y
CONFIG_NET_MEDIATEK_HNAT=y



# ---------------------------------------------------------
# BPF 子系统 · 控制面使用，非 XDP
# ---------------------------------------------------------
CONFIG_BPF=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF_JIT=y
CONFIG_BPF_EVENTS=y
# CONFIG_BPF_JIT_ALWAYS_ON is not set
# CONFIG_BPF_PRELOAD is not set
# CONFIG_DEBUG_INFO_BTF is not set


# ---------------------------------------------------------
# 调试 · 生产环境彻底关闭
# ---------------------------------------------------------
# CONFIG_DEBUG_KERNEL is not set
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_MISC is not set
# CONFIG_DEBUG_FS is not set
# CONFIG_MAGIC_SYSRQ is not set
# CONFIG_PCI_DEBUG is not set
# CONFIG_SYSCTL_EXCEPTION_TRACE is not set
# CONFIG_KALLSYMS is not set
# CONFIG_KALLSYMS_ALL is not set
# CONFIG_COREDUMP is not set
# CONFIG_PRINTK_TIME is not set

# 安全 · 保守且不牺牲性能
CONFIG_STACKPROTECTOR_STRONG=y
CONFIG_RODATA_FULL_DEFAULT_ENABLED=y
CONFIG_SECURITY=y
CONFIG_SECURITY_NETWORK=y

# A53 风险极低，但你当前选择“安全优先”
CONFIG_CPU_MITIGATIONS=y


# ---------------------------------------------------------
# 内核抢占模型 · 吞吐量取向
# ---------------------------------------------------------
CONFIG_KERNEL_PREEMPT_VOLUNTARY=y
# CONFIG_KERNEL_PREEMPT is not set


# ---------------------------------------------------------
# Namespaces / Cgroups · 路由器裁剪
# ---------------------------------------------------------
# CONFIG_USER_NS is not set
# CONFIG_PID_NS is not set
# CONFIG_IPC_NS is not set

# CONFIG_CGROUP_DEVICE is not set
# CONFIG_CGROUP_PIDS is not set
# CONFIG_CGROUP_FREEZER is not set
# CONFIG_CGROUP_CPUACCT is not set
# CONFIG_NET_CLS_CGROUP is not set
# CONFIG_RT_GROUP_SCHED is not set

CONFIG_IP6_NF_IPTABLES=m
CONFIG_IP6_NF_FILTER=m
CONFIG_IP6_NF_MANGLE=m
CONFIG_IP6_NF_RAW=m
CONFIG_NETFILTER=m
CONFIG_IPV6=y
