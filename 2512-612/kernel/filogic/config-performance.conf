# ===============================
# MT7986A · 最终稳定版内核注入
# ImmortalWrt 25.12 / Kernel 6.12
# fw4 / nftables
# ===============================

# ===== CPU / 调度 =====
CONFIG_HZ=250
CONFIG_HZ_250=y

CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y
# CONFIG_CPU_FREQ_GOV_PERFORMANCE is not set
# CONFIG_CPU_FREQ_GOV_ONDEMAND is not set
# CONFIG_CPU_FREQ_GOV_USERSPACE is not set
# CONFIG_CPU_FREQ_GOV_POWERSAVE is not set

# CONFIG_SCHED_AUTOGROUP is not set


# ===== 内存管理 =====
# CONFIG_TRANSPARENT_HUGEPAGE is not set
# CONFIG_ARCH_WANTS_THP_SWAP is not set


# ===== 网络路径 =====
# CONFIG_NET_BUSY_POLL is not set
# CONFIG_NET_RX_BUSY_POLL is not set

CONFIG_RPS=y
CONFIG_XPS=y
# CONFIG_RFS_ACCEL is not set


# ===== Conntrack =====
CONFIG_NF_CONNTRACK=y
CONFIG_NF_CONNTRACK_EVENTS=y
CONFIG_NF_CONNTRACK_TIMESTAMP=y
CONFIG_NF_CONNTRACK_NETLINK=y


# ===== Flow / HNAT =====
CONFIG_NF_FLOW_TABLE=y
CONFIG_NET_MEDIATEK_HNAT=y


# ===== 加密 =====
CONFIG_CRYPTO_AES_ARM64_CE=y
CONFIG_CRYPTO_SHA2_ARM64_CE=y
CONFIG_CRYPTO_GHASH_ARM64_CE=y
CONFIG_CRYPTO_SM4_ARM64_CE_GCM=y


# ===== BPF =====
CONFIG_BPF=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF_JIT=y
CONFIG_BPF_EVENTS=y
# CONFIG_BPF_JIT_ALWAYS_ON is not set
# CONFIG_BPF_PRELOAD is not set
# CONFIG_DEBUG_INFO_BTF is not set


# ===== 调试 =====
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_MISC is not set
# CONFIG_DEBUG_FS is not set
# CONFIG_MAGIC_SYSRQ is not set
# CONFIG_PCI_DEBUG is not set
# CONFIG_SYSCTL_EXCEPTION_TRACE is not set


# ===== 安全 =====
CONFIG_CPU_MITIGATIONS=y
CONFIG_RODATA_FULL_DEFAULT_ENABLED=y


# ===== Netfilter / fw4 =====
CONFIG_NETFILTER=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NETFILTER_XTABLES=y

# nftables（fw4 必须）
CONFIG_NF_TABLES=y
CONFIG_NF_TABLES_IPV4=y
CONFIG_NF_TABLES_IPV6=y

# IPv4 iptables（兼容 AppFilter）
CONFIG_IP_NF_IPTABLES=m
CONFIG_IP_NF_FILTER=m
CONFIG_IP_NF_NAT=m

# IPv6（不再使用 ip6tables）
CONFIG_IPV6=y
CONFIG_NF_DEFRAG_IPV6=y

# REJECT
CONFIG_NF_REJECT=y
CONFIG_NF_REJECT_IPV4=m
CONFIG_NF_REJECT_IPV6=m
