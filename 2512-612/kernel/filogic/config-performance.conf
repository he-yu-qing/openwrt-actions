# ===============================
#   MT7986A 极限稳定内核注入
# ===============================

# ===== CPU / 调度 =====
CONFIG_HZ=250
CONFIG_HZ_250=y

# 使用 schedutil（不要锁 performance）
CONFIG_CPU_FREQ_GOV_SCHEDUTIL=y
# CONFIG_CPU_FREQ_GOV_PERFORMANCE is not set
# CONFIG_CPU_FREQ_GOV_ONDEMAND is not set
# CONFIG_CPU_FREQ_GOV_USERSPACE is not set
# CONFIG_CPU_FREQ_GOV_POWERSAVE is not set

# 关闭调度器自动分组（服务器/桌面特性）
# CONFIG_SCHED_AUTOGROUP is not set


# ===== 内存管理 =====
# 明确关闭 THP
# CONFIG_TRANSPARENT_HUGEPAGE is not set
# CONFIG_ARCH_WANTS_THP_SWAP is not set

# 保留内核默认 MGLRU（无需强行注入）


# ===== 网络低延迟 =====
CONFIG_NET_BUSY_POLL=y
CONFIG_NET_RX_BUSY_POLL=y

CONFIG_RPS=y
CONFIG_RFS_ACCEL=y
CONFIG_XPS=y


# ===== Conntrack（AppFilter 必需）=====
CONFIG_NF_CONNTRACK=y
CONFIG_NF_CONNTRACK_EVENTS=y
CONFIG_NF_CONNTRACK_TIMESTAMP=y
CONFIG_NF_CONNTRACK_NETLINK=y


# ===== Flowtable / HNAT =====
CONFIG_NF_FLOW_TABLE=y
CONFIG_NET_MEDIATEK_HNAT=y


# ===== 加密加速（保持）=====
CONFIG_CRYPTO_AES_ARM64_CE=y
CONFIG_CRYPTO_SHA2_ARM64_CE=y
CONFIG_CRYPTO_GHASH_ARM64_CE=y
CONFIG_CRYPTO_SM4_ARM64_CE_GCM=y


# ===== BPF（必需最小集，必须开启）=====
CONFIG_BPF=y
CONFIG_BPF_SYSCALL=y
CONFIG_BPF_JIT=y
CONFIG_BPF_JIT_ALWAYS_ON=y
CONFIG_BPF_EVENTS=y


# ===== 明确不需要的 BPF 扩展 =====
# CONFIG_BPF_PRELOAD is not set
# CONFIG_DEBUG_INFO_BTF is not set


# ===== 调试 & 噪声 =====
# CONFIG_DEBUG_INFO is not set
# CONFIG_DEBUG_MISC is not set
# CONFIG_DEBUG_FS is not set
# CONFIG_MAGIC_SYSRQ is not set
# CONFIG_PCI_DEBUG is not set
# CONFIG_SYSCTL_EXCEPTION_TRACE is not set


# ===== 安全（保留）=====
CONFIG_CPU_MITIGATIONS=y
CONFIG_RODATA_FULL_DEFAULT_ENABLED=y


# ===== Netfilter REJECT（AppFilter / OAF 必需）=====
CONFIG_NF_REJECT=y
CONFIG_NF_REJECT_IPV4=m

# 基础 Netfilter 核心支持
CONFIG_NETFILTER=y
CONFIG_NETFILTER_ADVANCED=y
CONFIG_NETFILTER_XTABLES=m

# IPv4 相关（对应 kmod-nf-ipt）
CONFIG_IP_NF_IPTABLES=m
CONFIG_IP_NF_FILTER=m
CONFIG_IP_NF_NAT=m

# IPv6 核心及相关模块（对应 kmod-nf-ipt6）
CONFIG_IPV6=y
CONFIG_IP6_NF_IPTABLES=m
CONFIG_IP6_NF_FILTER=m
CONFIG_IP6_NF_NAT=m
